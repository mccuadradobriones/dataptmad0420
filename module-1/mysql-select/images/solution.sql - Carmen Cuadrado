[Sql-select] Carmen Cuadrado

Challenge 1 - Who Have Published What At Where?

select
authors.au_id as ID,
authors.au_lname as LAST_NAME,
authors.au_fname as FIRST_NAME,
titles.title as TITLE,
publishers.pub_name as PUBLISHER
from authors
join titleauthor on authors.au_id = titleauthor.au_id 
join titles on titleauthor.title_id = titles.title_id 
join publishers on titles.pub_id = publishers.pub_id
group by ID;


Challenge 2 - Who Have Published How Many At Where?

select
authors.au_id as ID,
authors.au_lname as LAST_NAME,
authors.au_fname as FIRST_NAME,
titles.title as TITLE,
publishers.pub_name as PUBLISHER,
count(titles.title_id) as WORKS_PUBLISHED
from authors
join titleauthor on authors.au_id = titleauthor.au_id 
join titles on titleauthor.title_id = titles.title_id 
join publishers on titles.pub_id = publishers.pub_id
group by ID;


Challenge 3 - Best Selling Authors

select
authors.au_id as ID,
authors.au_lname as LAST_NAME,
authors.au_fname as FIRST_NAME,
sum(sales.qty) as TOTAL
from authors
join titleauthor on authors.au_id = titleauthor.au_id 
join sales on titleauthor.title_id = sales.title_id  
group by ID
order by TOTAL desc
limit 3;

#I have the doubt if I have to take into account the number of titles or the number of books sold
select
authors.au_id as ID,
authors.au_lname as LAST_NAME,
authors.au_fname as FIRST_NAME,
COUNT(sales.title_id) as TOTAL
from authors
join titleauthor on authors.au_id = titleauthor.au_id 
join sales on titleauthor.title_id = sales.title_id  
group by ID
order by TOTAL desc
limit 3;

Challenge 4 - Best Selling Authors Ranking
select
authors.au_id as ID,
authors.au_lname as LAST_NAME,
authors.au_fname as FIRST_NAME,
COUNT(sales.title_id) as TOTAL
from authors
left join titleauthor on authors.au_id = titleauthor.au_id 
left join sales on titleauthor.title_id = sales.title_id  
group by ID
order by TOTAL desc
